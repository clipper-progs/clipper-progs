<!DOCTYPE html
                     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                     "DTD/xhtml1-transitional.dtd">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
   <meta name="Author" content="Kevin Cowtan" />
   <meta name="GENERATOR" content="Kevin's fingers" />
<title>CCP4 Program Suite</title></head>
<body>

<!-- ::INDEX_INFO::PIRATE::Supported::Density Modification - Molecular Averaging::Statistical Phase Improvement:::::::: -->

<h1>PIRATE (CCP4: Supported Program)</h1>
<h2>NAME</h2>
<p><b>pirate</b>
- Statistical Phase Improvement</p>

<h2>SYNOPSIS</h2>
<p>
<b>cpirate</b>
<b>-mtzin-ref </b><i>filename</i>
<b>-mtzin-wrk </b><i>filename</i>
<b>-mtzout </b><i>filename</i>
<b>-colin-ref-fo </b><i>colpath</i>
<b>-colin-ref-hl </b><i>colpath</i>
<b>-colin-wrk-fo </b><i>colpath</i>
<b>-colin-wrk-hl </b><i>colpath</i>
<b>-colin-wrk-free </b><i>colpath</i>
<b>-colout </b><i>colpath</i>
<b>-colout-hl </b><i>colpath</i>
<b>-colout-fc </b><i>colpath</i>
<b>-ncycles </b><i>cycles</i>
<b>-weight-expllk </b><i>weight</i>
<b>-weight-mapllk </b><i>weight</i>
<b>-weight-ramp </b><i>weight</i>
<b>-resolution </b><i>resolution/A</i>
<b>-stats-radius </b><i>radius/A</i>,<i>radius/A</i>
<b>-skew-content </b><i>factor</i>,<i>factor</i>
<b>-auto-content</b>
<b>-unbias</b>
<b>-evaluate</b>
<b>-strict-free</b>
<b>-seed </b><i>seed</i>
<b>-verbose </b><i>verbosity</i>
<b>-stdin </b>
<br />
[<a href="#keywords">Keyworded input</a>]</p>

<h2><a name="description"></a>DESCRIPTION</h2>

<p>'pirate' performs statistical phase improvement by classifying the
electron density map by sparseness/denseness and order/disorder, with
the aim of obtaining superior results to conventional solvent mask
based methods without requiring knowledge of the solvent content.</p>

<p>The target distributions are generated by a simulation calculation
using a known 'reference' structure for which calculated phases are
available. The success of the method is dependent on the features of
the reference structure matching those of the unsolved, 'work'
structure. For the common case of a protein of mostly equal atoms
(i.e. not a metalloprotein), a single reference structures can be
used, with modifications automatically applied to the reference
structure to match its features to the work structure.</p>

<h2><a name="howtorun"></a>HOW TO RUN PIRATE</h2>

<p>To get the best results from 'pirate', you should allow it to
modify the cell contents of the reference structure to match the
contents of the work structure. To do this, simply leave the
'auto-content' option selected, and use a generic reference structure
of medium solvent content, such as 1AJR.</p>

<p>Alternatively, you may run 'pirate' several times in 'evaluation'
mode to select the best reference structure. These initial runs are
for a single cycle only, and the output is ignored. Simply check the
Free-E correlation in the log file to determine which reference
structure gives the best results. Once you have identified the best
reference structure, make a longer run (3-9 cycles) to produce an
improved set of phases.</p>

<p>A set of reference structure may have been provided by whoever
installed 'pirate' on your system, otherwise you can generate one
using the 'Make ref structure' task. The structure 1AJR is good for
typical protein problems at resolutions up to 1.85A. For exotic cases
and high resolution cases you will have to provide your own reference
structures.  The 'Make ref structure' task requires ftp access to the
EBI - if your local firewall prevents this, you will have to fetch the
coordinate and structure factor files (pdbXXXX.ent.Z, rXXXXsf.ext.Z)
using your preferred tool, and then run the task using the local
files.
</p>

<p>You may have to adjust the log-likelihood weights in some cases -
particularly SAD, where the error estimates may be very poor. The
Free-E correlation is less helpful for this purpose - look at the maps
to decide if this is necessary.</p>


<h2><a name="files"></a>INPUT/OUTPUT FILES</h2>

<dl>
<dt>-mtzin-ref</dt> <dd>Input 'reference' MTZ file. This contains the
data for a known, reference structure. The required columns are F,
sigF, and a set of Hendrickson-Lattman (HL) coefficients describing
the calculated phases from the final model. Suitable reference
structures can be constructed from the PDB using the
makereference.csh script.</dd>

<dt>-mtzin-wrk</dt> <dd>Input 'work' MTZ file. This contains the data
for the unknown, work structure. The required columns are F, sigF, and
a set of HL coefficients from a phasing program (experimental or
molecular replacement). A Free-R flag may be provided. The HL
distributions should be accurate - in my experience no current program
fulfils this criterion, although Solve comes close. I have strong
hopes for Phaser. Currently, the input HL coefficients are corrected
using a user parameter.</dd>

<dt>-mtzout</dt> <dd>Output MTZ file. This will contain the updated HL
coefficients, and map coefficients for a best electron density map,
including restored values for missing reflections.</dd>
</dl>

<h2><a name="keywords"></a>KEYWORDED INPUT</h2>

See <a href="#notekeywords">Note on keyword input</a>.
<blockquote>
<h3><a name="colin-ref-fo"></a>-colin-ref-fo <i>colpath</i></h3>

<p>Observed F and sigma for reference structure. See <a
href="#notecolpaths">Note on column paths</a>.</p>

<h3><a name="colin-ref-hl"></a>-colin-ref-hl <i>colpath</i></h3>

<p>Hendrickson-Lattman coefficients for reference structure. If you do
not have these, they can be generated using the accompanying chltofom
program. See <a href="#notecolpaths">Note on column paths</a>.</p>

<h3><a name="colin-wrk-fo"></a>-colin-wrk-fo <i>colpath</i></h3>

<p>Observed F and sigma for work structure. See <a
href="#notecolpaths">Note on column paths</a>.</p>

<h3><a name="colin-wrk-hl"></a>-colin-wrk-hl <i>colpath</i></h3>

<p>Hendrickson-Lattman coefficients for work structure. See <a
href="#notecolpaths">Note on column paths</a>.</p>

<h3><a name="colin-wrk-free"></a>-colin-wrk-free <i>colpath</i></h3>

<p>[Optional] Free-R flag for work structure. See <a
href="#notecolpaths">Note on column paths</a>.</p>

<h3><a name="colout"></a>-colout <i>colpath</i></h3>

<p>[Optional] Column group name for all output columns.</p>

<h3><a name="colout-hl"></a>-colout-hl <i>colpath</i></h3>

<p>[Optional] Column group name for HL column group only.</p>

<h3><a name="colout-fc"></a>-colout-fc <i>colpath</i></h3>

<p>[Optional] Column group name for map coefficient group only.</p>

<h3><a name="ncycles"></a>-ncycles <i>cycles</i></h3>

<p>[Optional] Number of cycles to perform. Default is 1 cycle, to
produce a rigorous set of phase probability distributions and
statistics. For a best map, run 3-5 cycles.</p>

<h3><a name="weight-expllk"></a>-weight-expllk <i>weight</i></h3>

<p>[Optional] Weight to apply to input HL coefficients. This is to
correct for deficiencies in phasing programs. With next-generation
phasing software, this parameter will be fixed at 1.0. Until then, try
0.5, and then 1.0 and 2.0 if results are poor.</p>

<h3><a name="weight-mapllk"></a>-weight-mapllk <i>weight</i></h3>

<p>[Optional] Weight to apply to map likelihood. Default is 0.1. You
may be able to optimise this using the Free-E correl. Find the weight
which gives the best Free-E correl, and then divide it by 2 for your
final run.</p>

<h3><a name="weight-ramp"></a>-weight-ramp <i>weight</i></h3>

<p>[Optional] Weight for the ramping up of the map likelihood. Defaults
are 2.0 in normal mode and 1.0 in unbias mode.</p>

<h3><a name="resolution"></a>-resolution <i>resolution/A</i></h3>

<p>[Optional] Resolution limit for the calculation. All data is truncated.</p>

<h3><a name="stats-radius"></a>-stats-radius <i>radius/A</i>,<i>radius/A</i></h3>

<p>[Optional] Radius for local mean and standard deviation, used in
classifying the map. Default 9.0, 3.0A. First value is initial value, second is final value for multi-cycle calculations.</p>

<h3><a name="skew-content"></a>-skew-content <i>factor</i>,<i>factor</i></h3>

<p>[Optional] Factors for skewing the content of dense and ordered
density of the reference structure. +ve increases the specified
region, -ve decreases. Useful range is -1...+1.</p>

<h3><a name="auto-content"></a>-auto-content</h3>

<p>[Optional] Automatically refine values for content skewing to fit
the reference structure to the work structure. This is slow but gives
a better result.</p>

<h3><a name="unbias"></a>-unbias</h3>

<p>[Optional] Select '-unbias' to remove bias from molecular
replacement models. This is a more sophisticated version of the 'dm'
COMBINE WEIGHT option.</p>

<h3><a name="evaluate"></a>-evaluate</h3>

<p>[Optional] Select '-evaluate' to run a quick evaluation calculation
to test a reference structure.</p>

<h3><a name="strict-free"></a>-strict-free</h3>

<p>[Optional] Select '-strict-free' to keep the free-set for every
cycle of a multi-cycle calculation. This may lead to a worse map, but
may be a good idea if you want to try and refine against the final
output phases. A better option is to run only one cycle to produce
phases for refinement, or more to make a map.</p>

<h3><a name="seed"></a>-seed <i>seed</i></h3>
<h3><a name="verbose"></a>-verbose <i>verbosity</i></h3>
</blockquote>

<h4><a name="notecolpaths"></a>Note on column paths:</h4> <p>When
using the command line, MTZ columns are described as groups using a
slash separated format including the crystal and dataset name. If your
data was generated by another column-group using program, you can just
specify the name of the group, for example '/native/peak/Fobs'. You
can wildcard the crystal and dataset if the file does not contain any
duplicate labels, e.g. '/*/*/Fobs'. You can also access individual
non-grouped columns from existing files by giving a comma-separated
list of names in square brackets, e.g. '/*/*/[FP,SIGFP]'.</p>

<h4><a name="notekeywords"></a>Note on keyword input:</h4>
<p>Keywords may appear on the command line, or by specifying the
'-stdin' flag, on standard input. In the latter case, one keyword is
given per line and the '-' is optional, and the rest of the line is
the argument of that keyword if required, so quoting is not used in
this case.</p>

<h2>Reading the Output:</h2>

<p>The program outputs a short list of statistics each cycle. The
Free-E correlation is probably the most useful (larger is
better). After the first cycle these may be biased in various
ways. They are fairly useful for selecting a reference structure from
a list of candidates or for selecting a radius. They can be used to
control the likelihood weighting, but see the notes under the keyword
for the appropriate protocol.</p>

<h2>Problems:</h2>
<ul>
<li>If the work structure has centric reflections and the reference
structure does not, the program will fail.</li>
</ul>

<h2>AUTHOR</h2>
<p>Kevin Cowtan, York.</p>

<h2>SEE ALSO</h2>
<p></p>

</body>
</html>
